
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://granitewms.github.io/GraniteDocs/7.0/custodian-api/email-service/">
      
      
        <link rel="prev" href="../process-template-service/">
      
      
        <link rel="next" href="../reporting-service/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.5">
    
    
      
        <title>Email Service - Granite WMS Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../extra_css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#email-service" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Granite WMS Documentation" class="md-header__button md-logo" aria-label="Granite WMS Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Granite WMS Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Email Service
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../scaffold/manual/" class="md-tabs__link">
          
  
    
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tools/" class="md-tabs__link">
          
  
    
  
  Tools & Technology

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../customization/" class="md-tabs__link">
          
  
    
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../updates/" class="md-tabs__link">
          
  
    
  
  Release Notes

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Granite WMS Documentation" class="md-nav__button md-logo" aria-label="Granite WMS Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Granite WMS Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scaffold/manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaffold
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Label Printing
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Label Printing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../label-printing/bartender/manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bartender
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../label-printing/zpl/manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ZPL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Integration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../integration/accpac/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Accpac
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_1" id="__nav_2_3_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_1">
            <span class="md-nav__icon md-icon"></span>
            Accpac
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/accpac/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/accpac/integration-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../integration/acumatica/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Acumatica
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Acumatica
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/acumatica/acumatica-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Acumatica Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/acumatica/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/acumatica/integration-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../integration/cin7/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    CIN7
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_3" id="__nav_2_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_3">
            <span class="md-nav__icon md-icon"></span>
            CIN7
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/cin7/cin7-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CIN7 Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/cin7/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/cin7/integration-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../integration/evo/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Evolution
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_4" id="__nav_2_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_4">
            <span class="md-nav__icon md-icon"></span>
            Evolution
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/evo/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/evo/integration-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../integration/isync/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ISync
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_5" id="__nav_2_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_5">
            <span class="md-nav__icon md-icon"></span>
            ISync
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/isync/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/isync/integration-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/omni/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Omni
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/quickbooks/native-app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    QuickBooks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/sapb1/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SAPB1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/syspro/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Syspro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../integration/sage100/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Sage 100
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_10" id="__nav_2_3_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_10">
            <span class="md-nav__icon md-icon"></span>
            Sage 100
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/sage100/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/sage100/integration-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../integration/intacct/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Sage Intacct
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_11" id="__nav_2_3_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_11">
            <span class="md-nav__icon md-icon"></span>
            Sage Intacct
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/intacct/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/intacct/integration-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../integration/sagex3/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Sage X3
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3_12" id="__nav_2_3_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_12">
            <span class="md-nav__icon md-icon"></span>
            Sage X3
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/sagex3/sagex3-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sage X3 Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/sagex3/sdk-provider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SDK Provider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integration/sagex3/integration-jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Integration Jobs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../webdesktop/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Web Desktop
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            Web Desktop
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../webdesktop/datagrid/datagrid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../webdesktop/datacapture/data-capture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Capture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../process-app/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Process App
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            Process App
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../android-application/manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scanner Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../business-api/manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Business API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Custodian API
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_8">
            <span class="md-nav__icon md-icon"></span>
            Custodian API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process-template-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Process Template Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Email Service
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Email Service
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#email-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Email Providers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Email Providers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smtp" class="md-nav__link">
    <span class="md-ellipsis">
      SMTP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SMTP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-system-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Required System Settings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmail" class="md-nav__link">
    <span class="md-ellipsis">
      Gmail
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gmail">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-system-settings_1" class="md-nav__link">
    <span class="md-ellipsis">
      Required System Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allow-gmail-account-api-access" class="md-nav__link">
    <span class="md-ellipsis">
      Allow Gmail account API access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmail-authenticator" class="md-nav__link">
    <span class="md-ellipsis">
      Gmail Authenticator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#email-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Email Templates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Email Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#template-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Template Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Script Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Script Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#headerimage" class="md-nav__link">
    <span class="md-ellipsis">
      headerImage()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table" class="md-nav__link">
    <span class="md-ellipsis">
      table()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#footerblock-and-footeritem" class="md-nav__link">
    <span class="md-ellipsis">
      footerBlock() and footerItem()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clr-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      CLR Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLR Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sending-an-email" class="md-nav__link">
    <span class="md-ellipsis">
      Sending an Email
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sending an Email">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dboclr_templateemail" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.clr_TemplateEmail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addtemplateparameter" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddTemplateParameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboclr_simpleemail" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.clr_SimpleEmail
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attachments" class="md-nav__link">
    <span class="md-ellipsis">
      Attachments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attachments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssrs-reports" class="md-nav__link">
    <span class="md-ellipsis">
      SSRS Reports
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SSRS Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dboemail_createreportattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_CreateReportAttachment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addreportattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddReportAttachment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-table-exports" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Table exports
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL Table exports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dboemail_createexcelattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_CreateExcelAttachment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addexcelattachmentfilter" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddExcelAttachmentFilter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addexcelattachmentorderby" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddExcelAttachmentOrderBy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addexcelattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddExcelAttachment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-attachments" class="md-nav__link">
    <span class="md-ellipsis">
      File attachments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File attachments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dboemail_addfileattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddFileAttachment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reporting-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reporting Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sql-export-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQL Export Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduler/manual/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scheduler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../customization/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Development
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_9" id="__nav_2_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_9_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../sqlclr/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    SQLCLR
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_9_2" id="__nav_2_9_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_9_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_9_2">
            <span class="md-nav__icon md-icon"></span>
            SQLCLR
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sqlclr/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sqlclr/version-6-upgrade-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Version 6 Upgrade Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sqlclr/reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLR Procedure Reference
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../security/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Application Security
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_10" id="__nav_2_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_10">
            <span class="md-nav__icon md-icon"></span>
            Application Security
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/system-security/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    System Security
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/user-permissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../security/api-keys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Keys
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tools/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tools & Technology
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tools & Technology
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../iis/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IIS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ssrs/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSRS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/jam/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jam.dev
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/jaeger/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jaeger
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/nifi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apache NiFi
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../customization/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Development
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Guidelines
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Guidelines
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customization/intro-practice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro practice
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customization/triggers/triggers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Triggers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../customization/prescripts/prescripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pre Scripts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../updates/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Release Notes
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Release Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    What's New
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            What's New
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/V4/whats-new/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V4
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    V5
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_2">
            <span class="md-nav__icon md-icon"></span>
            V5
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/V5/whats-new/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Whats New
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/V5/product-update/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Product Update
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2_3" >
        
          
          <label class="md-nav__link" for="__nav_5_2_3" id="__nav_5_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    V6
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2_3">
            <span class="md-nav__icon md-icon"></span>
            V6
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/V6/whats-new/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Whats New
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/V6/cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CheatSheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/V7/whats-new/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    V7
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../updates/release-notes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hotfixes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#email-providers" class="md-nav__link">
    <span class="md-ellipsis">
      Email Providers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Email Providers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#smtp" class="md-nav__link">
    <span class="md-ellipsis">
      SMTP
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SMTP">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-system-settings" class="md-nav__link">
    <span class="md-ellipsis">
      Required System Settings
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmail" class="md-nav__link">
    <span class="md-ellipsis">
      Gmail
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gmail">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-system-settings_1" class="md-nav__link">
    <span class="md-ellipsis">
      Required System Settings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allow-gmail-account-api-access" class="md-nav__link">
    <span class="md-ellipsis">
      Allow Gmail account API access
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmail-authenticator" class="md-nav__link">
    <span class="md-ellipsis">
      Gmail Authenticator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#email-templates" class="md-nav__link">
    <span class="md-ellipsis">
      Email Templates
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Email Templates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#template-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Template Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Script Methods
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Script Methods">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#headerimage" class="md-nav__link">
    <span class="md-ellipsis">
      headerImage()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#table" class="md-nav__link">
    <span class="md-ellipsis">
      table()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#footerblock-and-footeritem" class="md-nav__link">
    <span class="md-ellipsis">
      footerBlock() and footerItem()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#clr-procedures" class="md-nav__link">
    <span class="md-ellipsis">
      CLR Procedures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CLR Procedures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sending-an-email" class="md-nav__link">
    <span class="md-ellipsis">
      Sending an Email
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sending an Email">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dboclr_templateemail" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.clr_TemplateEmail
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addtemplateparameter" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddTemplateParameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboclr_simpleemail" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.clr_SimpleEmail
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#attachments" class="md-nav__link">
    <span class="md-ellipsis">
      Attachments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attachments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssrs-reports" class="md-nav__link">
    <span class="md-ellipsis">
      SSRS Reports
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SSRS Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dboemail_createreportattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_CreateReportAttachment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addreportattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddReportAttachment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-table-exports" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Table exports
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SQL Table exports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dboemail_createexcelattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_CreateExcelAttachment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addexcelattachmentfilter" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddExcelAttachmentFilter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addexcelattachmentorderby" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddExcelAttachmentOrderBy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dboemail_addexcelattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddExcelAttachment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#file-attachments" class="md-nav__link">
    <span class="md-ellipsis">
      File attachments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="File attachments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dboemail_addfileattachment" class="md-nav__link">
    <span class="md-ellipsis">
      dbo.email_AddFileAttachment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="email-service">Email Service</h1>
<h2 id="configuration">Configuration</h2>
<div class="admonition warning">
<p class="admonition-title">Google shutting down access to sending mails via SMTP</p>
<p>As of January 2025, the Custodian API will not be able to send emails using SMTP.</p>
<p>If you are using a Gmail address to send emails, you will need to switch over to the new <a href="#gmail">Gmail provider</a></p>
</div>
<p>Settings for the Email Service are configured in the <code>SystemSettings</code> table. You can find the insert script for the settings in the GraniteDatabase install folder:</p>
<div class="highlight"><pre><span></span><code>&quot;...\GraniteDatabase\Data\SystemSettings\SystemSettingsCustodian.sql&quot;
</code></pre></div>
<p>You should have the following settings after running the script:</p>
<table>
<thead>
<tr>
<th>Application</th>
<th>Key</th>
<th>Value</th>
<th>Description</th>
<th>ValueDataType</th>
<th>isEncrypted</th>
<th>isActive</th>
</tr>
</thead>
<tbody>
<tr>
<td>Granite.Custodian</td>
<td>UserName</td>
<td></td>
<td>Username for the account that will be used to send email</td>
<td>string</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>Password</td>
<td></td>
<td>Password for the account that will be used to send email</td>
<td>string</td>
<td>True</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>Host</td>
<td>smtp.gmail.com</td>
<td>The address of the SMTP server</td>
<td>string</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>Port</td>
<td>587</td>
<td>Port number to be used when accessing the SMTP server</td>
<td>int</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>EnableSsl</td>
<td>true</td>
<td>Use SSL when accessing the SMTP server. True or False</td>
<td>bool</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>From</td>
<td></td>
<td>Email address that will be used to send mail</td>
<td>string</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>FromName</td>
<td></td>
<td>The sender name that will display to users who receive emails</td>
<td>string</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>RetryInterval</td>
<td>30</td>
<td>Number of seconds to wait before retrying processing an email</td>
<td>int</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>MaxNumberOfRetries</td>
<td>3</td>
<td>Maximum number of times to retry processing an email.</td>
<td>int</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>EmailAttachmentFolder</td>
<td></td>
<td>Full filepath to folder to export email attachments to. Leave empty to use the Custodian install folder</td>
<td>string</td>
<td>False</td>
<td>True</td>
</tr>
<tr>
<td>Granite.Custodian</td>
<td>EmailProvider</td>
<td></td>
<td>Provider to use for sending emails. If empty, we will use the SMTP provider.</td>
<td>string</td>
<td>False</td>
<td>True</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Password isEncrypted is True</p>
<p>You will only be able to change the value of this setting from the Webdesktop System Settings page</p>
</div>
<h3 id="email-providers">Email Providers</h3>
<p>Email Providers allow us to configure the way that we send emails for different types of email accounts.
At the moment we support sending email using a SMTP server directly, or using the Gmail API.</p>
<p>Note that as of January 2025, Gmail no longer allows sending emails using their SMTP server directly.
This is why configuring the Email Service to send email via a Gmail account works slightly differently.</p>
<p>To configure the <code>EmailProvider</code>, set the name of the provider you want to use in SystemSettings.
If the <code>EmailProvider</code> setting is empty, it will default to using the SMTP provider.</p>
<h4 id="smtp">SMTP</h4>
<p>Sending email via SMTP is quite straightforward, all you need is the credentials of the account that you are using to send email, and the details of the server that you are using to send email. These get configured in the <code>System Settings</code></p>
<h5 id="required-system-settings">Required System Settings</h5>
<ul>
<li>UserName - User name to use when connecting to the SMTP server</li>
<li>Password - Password to use when connecting to the SMTP server</li>
<li>Host - The host address of the SMTP server (server name or IP)</li>
<li>Port - The port number to use when accessing the SMTP server</li>
<li>EnableSsl - Use SSL when accessing the SMTP server. True or False</li>
<li>From - The email address that you are sending mail from</li>
<li>FromName - The sender name that will display to users who receive emails</li>
</ul>
<h4 id="gmail">Gmail</h4>
<p>Since Gmail has blocked access to SMTP, sending email via a Gmail account involves more set up.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are updating in order to continue using the GraniteWMS Info to send email, all you need to do is the following:</p>
<ol>
<li>
<p>Deploy the latest Custodian API </p>
</li>
<li>
<p>Run the SQL script at <code>...\Granite Releases\Granite Info Gmail Auth\CustodianSystemSettings.sql</code></p>
</li>
<li>
<p>Copy the GmailTokens folder <code>...\Granite Releases\Granite Info Gmail Auth\GmailTokens</code> into the GraniteCustodian folder</p>
</li>
</ol>
</div>
<p>To send email via Gmail, you will first need to <a href="#allow-gmail-account-api-access">enable Gmail API access</a> for the account you're using and obtain the <code>Client ID</code> and <code>Client secret</code>.
These are the UserName and Password that you will need to set in <code>SystemSettings</code>.</p>
<p>Next, you will need to place the API token file in the <code>...\GraniteCustodian\GmailTokens</code> folder.
If you have the token file for the account you are using already, you can simply paste it in.
Otherwise, you will need to run the <a href="#gmail-authenticator">Gmail Authenticator</a> to obtain the token file.</p>
<h5 id="required-system-settings_1">Required System Settings</h5>
<ul>
<li>UserName - The Client ID used to connect to the Gmail API</li>
<li>Password - The Client secret used to connect to the Gmail API</li>
<li>From - The email address that you are sending mail from</li>
<li>FromName - The sender name that will display to users who receive emails</li>
</ul>
<h5 id="allow-gmail-account-api-access">Allow Gmail account API access</h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This configuration has already been completed for the GraniteWMS Info account, it does not need to be performed again.</p>
<p>If you are using the GraniteWMS Info account, use the script in Dropbox to update your SystemSettings and then run the <a href="#gmail-authenticator">GmailAuthenticator</a> app to log in.</p>
</div>
<p>To allow Email Service access to the Gmail account in order to send email, we will need to configure some settings on the Gmail account.</p>
<p>Browse to <a href="https://console.cloud.google.com">https://console.cloud.google.com</a> and log in with the account that you want to use, then follow the steps below.</p>
<ol>
<li>
<p>Click the <code>Select a project</code> button on the top left</p>
<p><img alt="" src="../img/gmail1.png" /></p>
</li>
<li>
<p>Click the <code>New Project</code> button on the top right of the box.</p>
<p><img alt="" src="../img/gmail2.png" /></p>
</li>
<li>
<p>Give the new project a name e.g. <code>GraniteCustodianAPI</code>.
You shouldn't need to change the Location/Organization. Just keep the default and click <code>CREATE</code></p>
<p><img alt="" src="../img/gmail3.png" /></p>
</li>
<li>
<p>Click the hamburger menu on the top left and select <code>Enabled APIs &amp; services</code> from the menu</p>
<p><img alt="" src="../img/gmail4.png" /></p>
</li>
<li>
<p>Click the <code>Enable APIs and Services</code> button</p>
<p><img alt="" src="../img/gmail5.png" /></p>
</li>
<li>
<p>Search for "gmail", click on the Gmail API entry and then click the <code>Enable</code> button</p>
<p><img alt="" src="../img/gmail6.png" /></p>
</li>
<li>
<p>Once the Gmail API is enabled, select the <code>OAuth consent screen</code> from the menu on the left</p>
<p><img alt="" src="../img/gmail7.png" /></p>
</li>
<li>
<p>On the OAuth consent screen, select User Type <code>Internal</code> and click <code>Create</code></p>
<p><img alt="" src="../img/gmail8.png" /></p>
</li>
<li>
<p>Select the Application type <code>Web application</code>. 
Enter an App name e.g. <code>Granite.Custodian.Api</code>, a user support email address and a developer contact email address. 
You can set both of the email addresses to the email address that you are using to send email.
Click the <code>Save and Continue</code> button once you've entered the required fields.</p>
<p><img alt="" src="../img/gmail9.png" /></p>
</li>
<li>
<p>Click the <code>Add or Remove Scopes</code> button</p>
<p><img alt="" src="../img/gmail10.png" /></p>
</li>
<li>
<p>Filter the list of scopes by <code>Gmail API</code> and select the scope <code>https://mail.google.com</code>. 
Scroll to the bottom of the page and click <code>Update</code></p>
<p><img alt="" src="../img/gmail11.png" /></p>
</li>
<li>
<p>Now that the scope has been added, scroll down to the bottom of the page and click <code>Save and Continue</code></p>
<p><img alt="" src="../img/gmail12.png" /></p>
</li>
<li>
<p>Select <code>Credentials</code> from the menu on the left</p>
<p><img alt="" src="../img/gmail13.png" /></p>
</li>
<li>
<p>Click the <code>Create Credentials</code> button at the top and select <code>OAuth client ID</code></p>
<p><img alt="" src="../img/gmail14.png" /></p>
</li>
<li>
<p>Give the client ID a name, e.g. <code>Granite.Custodian.Api</code>. 
Under Authorized redirect URIs add both <code>http://localhost/authorize/</code> and <code>http://127.0.0.1/authorize/</code>
Then click the <code>Create</code> button at the bottom</p>
<p><img alt="" src="../img/gmail15.png" /></p>
</li>
<li>
<p>Take note of the <code>Client ID</code> and the <code>Client secret</code>. 
These are the <code>UserName</code> and <code>Password</code> that you will need for SystemSettings</p>
<p><img alt="" src="../img/gmail16.png" /></p>
</li>
<li>
<p>Set the <code>Client ID</code> and <code>Client secret</code> as your <code>UserName</code> and <code>Password</code> in SystemSettings. 
While you are in SystemSettings, also ensure that you have the <code>EmailProvider</code> setting and that the value is set to <code>GMAIL</code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code>Client secret</code> must be encrypted. Ensure that you save it through the Webdesktop so that it is not stored in plaintext.</p>
</div>
</li>
</ol>
<h5 id="gmail-authenticator">Gmail Authenticator</h5>
<p>The Gmail Authenticator connects to the Gmail API using the Client ID and Client secret from System Settings, and fetches tokens that allow the Custodian API to connect to the Gmail API.
This is a once off set up, once you have authenticated, the Email Service will be able to send email via Gmail.</p>
<ol>
<li>
<p>Open a browser window that is either signed in with the Gmail account you are planning to use, or not signed in to any Gmail account. The Guest mode in Chrome works well for this.</p>
</li>
<li>
<p>Browse to the folder where you have installed Custodian, and into the <code>GmailAuthenticator</code> folder. 
Run the <code>Granite.Email.GmailAuthenticator.exe</code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Granite.Email.GmailAuthenticator.exe uses the Custodian's appSettings.json file. 
Make sure that it is configured before trying to authenticate the Gmail account.</p>
</div>
</li>
<li>
<p>A new browser tab will open asking you to log in to authorize the Custodian API. 
Log in with the Gmail account that you are going to use to send emails. 
Log in with the <strong>normal username and password</strong> - NOT the Client ID and Client secret</p>
</li>
</ol>
<p>After signing in via the browser, Gmail Authenticator will place the received token file into the <code>...\GraniteCustodian\GmailTokens</code> folder</p>
<h2 id="email-templates">Email Templates</h2>
<p>Email templates use MARKDOWN for text formatting - HTML is not supported. 
If you're not familiar with markdown, take a look at the <a href="https://www.markdownguide.org/cheat-sheet/">syntax cheat-sheet</a>.</p>
<p>To embed images and tables in the body of your email, Email Templates use Script Methods similar to the Web Template's Script Methods.</p>
<h3 id="template-manager">Template Manager</h3>
<p>The Template Manager is how you design and preview your email templates before using them. 
It has full auditing, so you can see which user has made changes to the Email Templates, as well as what has changed.</p>
<p>To copy an existing template, select it from the dropdown and then select New Template. 
When you save the template you will be prompted to give your new template a name.</p>
<h3 id="script-methods">Script Methods</h3>
<p>Script methods are the building blocks of your emails. 
You can use these to add images, tables, and more to the body of your email.</p>
<p>Each currently available Script Method is described below:</p>
<h4 id="headerimage">headerImage()</h4>
<p>The headerImage() script method allows you to add an image as a header to the top of your email.</p>
<p>Available parameters:</p>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>imageUrl</td>
<td>string</td>
<td>Yes</td>
<td>The url of the image that you want in your header</td>
</tr>
<tr>
<td>imageAltText</td>
<td>string</td>
<td>No</td>
<td>Text that will display in place of image if link is broken</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>string</td>
<td>No</td>
<td>Solid block of color behind the image. Can be hexcode or word</td>
</tr>
</tbody>
</table>
<p>Code example:</p>
<div class="highlight"><pre><span></span><code>{{
    headerImage(
    {
      imageUrl:&#39;https://www.granitewms.com/wp-content/uploads/2020/07/GraniteWMS-1.png&#39;,
      imageAltText:&#39;GraniteWMS logo&#39;,
      backgroundColor:&#39;#182026&#39;
    })
}}
</code></pre></div>
<h4 id="table">table()</h4>
<p>The <code>table()</code> script method works together with the <code>dbSelect()</code> method to take a SQL string as an input and return the result as a table.</p>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>sumColumns</td>
<td>string[]</td>
<td>No</td>
<td>Comma separated list of columns to sum in the table footer</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>string</td>
<td>No</td>
<td>Background color for the table's header and footer</td>
</tr>
<tr>
<td>textColor</td>
<td>string</td>
<td>No</td>
<td>Text color for the table's header and footer text</td>
</tr>
</tbody>
</table>
<p>Code example:</p>
<div class="highlight"><pre><span></span><code>{{    
    &#39;SELECT * FROM EmailTemplate_OrderDetail WHERE DocumentNumber = @documentNumber&#39;
    | dbSelect({documentNumber})
    | table({backgroundColor: &#39;#182026&#39;, textColor: &#39;white&#39;, sumColumns:[&#39;Qty&#39;,&#39;Price&#39;]})
}}
</code></pre></div>
<h4 id="footerblock-and-footeritem">footerBlock() and footerItem()</h4>
<p>The <code>footerItem()</code> script method can be chained together with more <code>footerItem()</code>'s which are then passed into the <code>footerBlock()</code> to add a footer to your email.</p>
<p>FooterItem parameters:</p>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>imageUrl</td>
<td>string</td>
<td>No</td>
<td>Url of the image to include in this footer item</td>
</tr>
<tr>
<td>imageWidth</td>
<td>int</td>
<td>No</td>
<td>Width of the image in pixels. Height will scale automatically</td>
</tr>
<tr>
<td>text</td>
<td>string</td>
<td>No</td>
<td>Text to include in this footer item</td>
</tr>
<tr>
<td>url</td>
<td>string</td>
<td>No</td>
<td>Url to link to if this footer item is clicked on</td>
</tr>
</tbody>
</table>
<p>FooterBlock parameters:</p>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Data Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>textColor</td>
<td>string</td>
<td>No</td>
<td>Color of the text in the footerBlock</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>string</td>
<td>No</td>
<td>Color of the background block for the whole footerBlock</td>
</tr>
</tbody>
</table>
<p>Code example:</p>
<div class="highlight"><pre><span></span><code>{{
    footerItem(
    { 
        imageUrl:&#39;https://cdn1.iconfinder.com/data/icons/logotypes/32/square-facebook-1024.png&#39;,
        imageWidth: 50,
        url:&#39;https://www.facebook.com/StarWarsAfrica/&#39;
    })
    | footerItem(
    { 
        imageUrl:&#39;https://cdn2.iconfinder.com/data/icons/social-icons-33/128/Instagram-1024.png&#39;,
        imageWidth: 50,
        url:&#39;https://www.instagram.com/starwars&#39;
    })
    | footerBlock({backgroundColor:&#39;#182026&#39;, textColor:&#39;lightgray&#39; })
}}
</code></pre></div>
<h2 id="clr-procedures">CLR Procedures</h2>
<h3 id="sending-an-email">Sending an Email</h3>
<p>When you make a request to send an email, the email is immediately entered into the <code>Email</code> table in the database.
If your email is a templated email, the template is rendered just before the entry is created in the <code>Email</code> table.
The Email Service will give you a response as soon as the email is queued in the table. 
From there, the email is passed to background services to fetch any attachments. 
Once the attachments have been gathered, the email will be sent.</p>
<p>If any of the background services are unable to complete their job, 
whether that be fetching an attachment or actually sending the mail, they will retry until the task succeeds or the 
<code>MaxNumberOfRetries</code> configured in SystemSettings is reached.</p>
<p>When the <code>MaxNumberOfRetries</code> is reached, the mail's status is set to FAILED and will not be retried without manual intervention.</p>
<p>Two types of emails can be sent using SQLCLR:</p>
<ul>
<li><a href="#dbo.clr_templateemail">Template Emails</a></li>
<li><a href="#dbo.clr_simpleemail">Simple Emails</a></li>
</ul>
<p>The difference between these two types of emails is where the content of the email body comes from. 
Templated emails require an email template that will be used to generate the body of the email. 
Simple emails can only contain unformatted text in the body of the email.
For more info on these, as well as help with designing your own email templates, see the Custodian API manual.</p>
<p>Both types of emails have support for the following types of attachments:</p>
<ul>
<li>SSRS Reports</li>
<li>Excel exports of SQL tables</li>
<li>File attachments</li>
</ul>
<h4 id="dboclr_templateemail">dbo.clr_TemplateEmail</h4>
<p>Use this procedure to send an email that uses an Email template to generate the body of the email.</p>
<table>
<thead>
<tr>
<th>Parameter Name</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>subject</td>
<td>Yes</td>
<td>The subject of the email</td>
</tr>
<tr>
<td>templateName</td>
<td>Yes</td>
<td>The name of the email template to use for the body of this email</td>
</tr>
<tr>
<td>templateParameters</td>
<td>No</td>
<td>List of parameters to pass into the email template to render the body of the email</td>
</tr>
<tr>
<td>toEmailAddresses</td>
<td>No</td>
<td>Semicolon delimited list of email addresses to address this email to</td>
</tr>
<tr>
<td>ccEmailAddresses</td>
<td>No</td>
<td>Semicolon delimited list of email address to CC on this email</td>
</tr>
<tr>
<td>bccEmailAddresses</td>
<td>No</td>
<td>Semicolon delimited list of email addresses to BCC on this email</td>
</tr>
<tr>
<td>reportAttachments</td>
<td>No</td>
<td>List of SSRS reports to attach to this email</td>
</tr>
<tr>
<td>excelAttachments</td>
<td>No</td>
<td>List of excel exports to attach to this email</td>
</tr>
<tr>
<td>fileAttachments</td>
<td>No</td>
<td>List of files to attach to this email</td>
</tr>
</tbody>
</table>
<h4 id="dboemail_addtemplateparameter">dbo.email_AddTemplateParameter</h4>
<p>Use this function to add parameters to the list that will be used to render the email template</p>
<table>
<thead>
<tr>
<th>Parameter Name</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>templateParameters</td>
<td>Yes</td>
<td>The list of template parameters</td>
</tr>
<tr>
<td>parameterName</td>
<td>Yes</td>
<td>The name of the parameter as it appears in the email template</td>
</tr>
<tr>
<td>parameterValue</td>
<td>Yes</td>
<td>The value that you are passing into the parameter</td>
</tr>
</tbody>
</table>
<p>Example usage</p>
<div class="highlight"><pre><span></span><code><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">templateName</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">templateParameters</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">ccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">bccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">reportAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">excelAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">fileAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="nb">bit</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>

<span class="k">BEGIN</span><span class="w"> </span><span class="n">TRY</span>

<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Test Clr Mail&#39;</span><span class="w">                                                                          </span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">templateName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;PickingNotification&#39;</span><span class="w"> </span><span class="c1">-- Use the email template named PickingNotification</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">templateParameters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_AddTemplateParameter</span><span class="p">(</span><span class="o">@</span><span class="n">templateParameters</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;documentNumber&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SO000123&#39;</span><span class="p">)</span><span class="w"> </span><span class="c1">-- Add a parameter to be passed to the email template. The parameter name is documentNumber, and value is SO000123</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;email1@gmail.com;email2@gmail.com&#39;</span><span class="w">                                     </span>

<span class="w">    </span><span class="k">EXECUTE</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">clr_TemplateEmail</span><span class="p">]</span><span class="w"> </span>
<span class="w">        </span><span class="o">@</span><span class="n">subject</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">templateName</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">templateParameters</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">toEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">ccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">bccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">reportAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">excelAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">fileAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="k">OUTPUT</span>

<span class="k">END</span><span class="w"> </span><span class="n">TRY</span>
<span class="k">BEGIN</span><span class="w"> </span><span class="n">CATCH</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ERROR_MESSAGE</span><span class="p">()</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="k">END</span><span class="w"> </span><span class="n">CATCH</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">message</span>
</code></pre></div>
<h4 id="dboclr_simpleemail">dbo.clr_SimpleEmail</h4>
<table>
<thead>
<tr>
<th>Parameter Name</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>subject</td>
<td>Yes</td>
<td>The subject of the email</td>
</tr>
<tr>
<td>body</td>
<td>Yes</td>
<td>The string content that will make up the body of the email</td>
</tr>
<tr>
<td>toEmailAddresses</td>
<td>No</td>
<td>Semicolon delimited list of email addresses to address this email to</td>
</tr>
<tr>
<td>ccEmailAddresses</td>
<td>No</td>
<td>Semicolon delimited list of email address to CC on this email</td>
</tr>
<tr>
<td>bccEmailAddresses</td>
<td>No</td>
<td>Semicolon delimited list of email addresses to BCC on this email</td>
</tr>
<tr>
<td>reportAttachments</td>
<td>No</td>
<td>List of SSRS reports to attach to this email</td>
</tr>
<tr>
<td>excelAttachments</td>
<td>No</td>
<td>List of excel exports to attach to this email</td>
</tr>
<tr>
<td>fileAttachments</td>
<td>No</td>
<td>List of files to attach to this email</td>
</tr>
</tbody>
</table>
<p>Example usage</p>
<div class="highlight"><pre><span></span><code><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">body</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">ccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">bccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">reportAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">excelAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">fileAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="nb">bit</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>

<span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Test Clr Mail&#39;</span><span class="w"> </span>
<span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">body</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Test mail&#39;</span>
<span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;email1@gmail.com;email2@gmail.com&#39;</span>

<span class="k">BEGIN</span><span class="w"> </span><span class="n">TRY</span>
<span class="w">    </span><span class="k">EXECUTE</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">clr_SimpleEmail</span><span class="p">]</span><span class="w"> </span>
<span class="w">        </span><span class="o">@</span><span class="n">subject</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">body</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">toEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">ccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">bccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">reportAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">excelAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">fileAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="k">END</span><span class="w"> </span><span class="n">TRY</span>
<span class="k">BEGIN</span><span class="w"> </span><span class="n">CATCH</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ERROR_MESSAGE</span><span class="p">()</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="k">END</span><span class="w"> </span><span class="n">CATCH</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">message</span>
</code></pre></div>
<h3 id="attachments">Attachments</h3>
<p>When you send an email with attachments, copies of those attachments are saved to the <code>EmailAttachmentFolder</code> specified in SystemSettings. 
The attachments for any given email will be placed in a subfolder named with the <code>ID</code> of the email in the <code>Email</code> database table.
This allows you to go back at any point to check the contents of the files that were sent as attachments.</p>
<h4 id="ssrs-reports">SSRS Reports</h4>
<p>To attach SSRS reports, ensure the <a href="../reporting-service/">Reporting Service</a> is configured correctly and working.</p>
<p>Attaching an SSRS report works very similarly to printing or exporting the report directly from the Reporting Service. 
The difference is that the Email Service will make the request to fetch the report after the email has been queued in the database.</p>
<p>Browse the API's documentation page (<code>/metadata</code>) for details on the properties needed to attach an SSRS report. 
The details can be found on the TemplateEmail or SimpleEmail requests.</p>
<h5 id="dboemail_createreportattachment">dbo.email_CreateReportAttachment</h5>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>reportPath</td>
<td>Yes</td>
<td>The path to this report in SSRS. You can find the report path by browsing the CustodianAPI's reports page</td>
</tr>
<tr>
<td>fileType</td>
<td>Yes</td>
<td>The file type that the report should be exported to. Valid values are PDF, EXCELOPENXML, or EXCEL</td>
</tr>
</tbody>
</table>
<p>dbo.email_AddReportParameter</p>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>reportAttachment</td>
<td>Yes</td>
<td>The report attachment that you are adding the parameter to. This must be created using the CreateReportAttachment function</td>
</tr>
<tr>
<td>parameterName</td>
<td>Yes</td>
<td>The name of the SSRS report parameter you want to set</td>
</tr>
<tr>
<td>parameterValue</td>
<td>Yes</td>
<td>The value that you want to set the SSRS report parameter to</td>
</tr>
</tbody>
</table>
<h5 id="dboemail_addreportattachment">dbo.email_AddReportAttachment</h5>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>reportAttachments</td>
<td>Yes</td>
<td>The variable that contains the list of report attachments that you are going to send</td>
</tr>
<tr>
<td>reportAttachmentToAdd</td>
<td>Yes</td>
<td>The variable that contains the report that you want to add to the list of reports that you are going to send</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight"><pre><span></span><code><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">body</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">ccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">bccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">reportAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">excelAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">fileAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="nb">bit</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">PickingReport</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>

<span class="k">BEGIN</span><span class="w"> </span><span class="n">TRY</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">PickingReport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_CreateReportAttachment</span><span class="p">(</span><span class="s1">&#39;/PickingReport&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PDF&#39;</span><span class="p">)</span><span class="w">                  </span><span class="c1">-- Creating the report that we want to attach. The reportPath is /PickingReport, and fileType is PDF</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">PickingReport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_AddReportParameter</span><span class="p">(</span><span class="o">@</span><span class="n">PickingReport</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;documentNumber&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SO0001&#39;</span><span class="p">)</span><span class="w">       </span><span class="c1">-- Adding a parameter that will be used to call the SSRS report. The parameter named &#39;documentNumber&#39; will be set to &#39;SO0001&#39;</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">reportAttachments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_AddReportAttachment</span><span class="p">(</span><span class="o">@</span><span class="n">reportAttachments</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">PickingReport</span><span class="p">)</span><span class="w">      </span><span class="c1">-- Lastly, we add the picking report to the list of report attachments. </span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Test Clr Mail&#39;</span><span class="w"> </span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;email1@gmail.com;email2@gmail.com&#39;</span>

<span class="w">    </span><span class="k">EXECUTE</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">clr_SimpleEmail</span><span class="p">]</span><span class="w"> </span>
<span class="w">        </span><span class="o">@</span><span class="n">subject</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">body</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">toEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">ccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">bccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">reportAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">excelAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">fileAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="k">END</span><span class="w"> </span><span class="n">TRY</span>
<span class="k">BEGIN</span><span class="w"> </span><span class="n">CATCH</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ERROR_MESSAGE</span><span class="p">()</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="k">END</span><span class="w"> </span><span class="n">CATCH</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">message</span>
</code></pre></div>
<h4 id="sql-table-exports">SQL Table exports</h4>
<p>To attach SQL Table exports, ensure the <a href="../sql-export-service/">SQLExport Service</a> is configured correctly and working.</p>
<p>Attaching an excel export works very similarly to exporting the data directly from the SQLExport Service. 
The difference is that the Email Service will make the request to export the data after the email has been queued in the database.</p>
<p>Browse the API's documentation page (<code>/metadata</code>) for details on the properties needed to attach a SQL Table Export. 
The details can be found on the TemplateEmail or SimpleEmail requests.</p>
<h5 id="dboemail_createexcelattachment">dbo.email_CreateExcelAttachment</h5>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>tableName</td>
<td>Yes</td>
<td>The name of the table or view that you want to export results from</td>
</tr>
<tr>
<td>fileType</td>
<td>Yes</td>
<td>The file type that the data should be exported to. Valid values are CSV or EXCEL</td>
</tr>
</tbody>
</table>
<h5 id="dboemail_addexcelattachmentfilter">dbo.email_AddExcelAttachmentFilter</h5>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>excelAttachment</td>
<td>Yes</td>
<td>The excel attachment you are adding a filter to. The variable passed in must be created using the CreateExcelAttachment function</td>
</tr>
<tr>
<td>filterColumn</td>
<td>Yes</td>
<td>The column that you want to filter on</td>
</tr>
<tr>
<td>filterType</td>
<td>Yes</td>
<td>The filter operation you want to perform. Valid values are Equal, NotEqual, Like, NotLike, StartsWith, EndsWith, Between, GreaterThan, GreaterThan, GreaterThanOrEqual, LessThan, LessThanOrEqual</td>
</tr>
<tr>
<td>filterValue</td>
<td>Yes</td>
<td>The value you want to filter by</td>
</tr>
</tbody>
</table>
<h5 id="dboemail_addexcelattachmentorderby">dbo.email_AddExcelAttachmentOrderBy</h5>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>excelAttachment</td>
<td>Yes</td>
<td>The excel attachment you are adding a filter to. The variable passed in must be created using the CreateExcelAttachment function</td>
</tr>
<tr>
<td>orderByColumn</td>
<td>Yes</td>
<td>The column that you want to order by</td>
</tr>
<tr>
<td>orderByType</td>
<td>Yes</td>
<td>Order by ascending or descending. Valid values are ASC or DESC</td>
</tr>
</tbody>
</table>
<h5 id="dboemail_addexcelattachment">dbo.email_AddExcelAttachment</h5>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>excelAttachments</td>
<td>Yes</td>
<td>The variable that contains the list of excel attachments that you are going to send</td>
</tr>
<tr>
<td>excelAttachmentToAdd</td>
<td>Yes</td>
<td>The variable that contains the excel attachment that you want to add to the list of attachments that you are going to send</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight"><pre><span></span><code><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">body</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">ccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">bccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">reportAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">excelAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">fileAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="nb">bit</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>

<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">ConsumablesExport</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>

<span class="k">BEGIN</span><span class="w"> </span><span class="n">TRY</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">ConsumablesExport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_CreateExcelAttachment</span><span class="p">(</span><span class="s1">&#39;CustomView_MasterItem&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CSV&#39;</span><span class="p">)</span><span class="w">                                </span><span class="c1">-- Create the excel attachment. The view we will pull from is CustomView_MasterItem, and it will export to a csv file </span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">ConsumablesExport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_AddExcelAttachmentFilter</span><span class="p">(</span><span class="o">@</span><span class="n">ConsumablesExport</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Category&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Equal&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;CONSUMABLE&#39;</span><span class="p">)</span><span class="w">  </span><span class="c1">-- Add a filter on the Category column of the view, fetch results where Category is equal to CONSUMABLE</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">ConsumablesExport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_AddExcelAttachmentOrderBy</span><span class="p">(</span><span class="o">@</span><span class="n">ConsumablesExport</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Description&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ASC&#39;</span><span class="p">)</span><span class="w">              </span><span class="c1">-- Order the results of the export using the Description column in ascending order</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">excelAttachments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_AddExcelAttachment</span><span class="p">(</span><span class="o">@</span><span class="n">excelAttachments</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">ConsumablesExport</span><span class="p">)</span><span class="w">                         </span><span class="c1">-- Lastly, we add the export to the list of excel attachments</span>

<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Test Clr Mail&#39;</span><span class="w"> </span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;email1@gmail.com;email2@gmail.com&#39;</span>

<span class="w">    </span><span class="k">EXECUTE</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">clr_SimpleEmail</span><span class="p">]</span><span class="w"> </span>
<span class="w">        </span><span class="o">@</span><span class="n">subject</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">body</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">toEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">ccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">bccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">reportAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">excelAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">fileAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="k">END</span><span class="w"> </span><span class="n">TRY</span>
<span class="k">BEGIN</span><span class="w"> </span><span class="n">CATCH</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ERROR_MESSAGE</span><span class="p">()</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="k">END</span><span class="w"> </span><span class="n">CATCH</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">message</span>
</code></pre></div>
<h4 id="file-attachments">File attachments</h4>
<p>File attachments allow you to specify a file path to the file that you want to attach.
When fetching this attachment type, the Email Service will copy the file into the email attachment folder configured in the SystemSettings table.
This is to ensure that a copy is kept for future reference in case the original is ever moved or deleted.</p>
<p>Browse the API's documentation page (<code>/metadata</code>) for details on the properties needed to attach a File Attachment. 
The details can be found on the TemplateEmail or SimpleEmail requests.</p>
<h5 id="dboemail_addfileattachment">dbo.email_AddFileAttachment</h5>
<table>
<thead>
<tr>
<th>ParameterName</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>fileAttachments</td>
<td>Yes</td>
<td>The variable that contains all the file attachment paths that will be sent with the email</td>
</tr>
<tr>
<td>fileToAttach</td>
<td>Yes</td>
<td>The path to the file that you want to add as an attachment</td>
</tr>
</tbody>
</table>
<p>Example</p>
<div class="highlight"><pre><span></span><code><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">body</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">ccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">bccEmailAddresses</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">reportAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">excelAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">fileAttachments</span><span class="w"> </span><span class="n">nvarchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="nb">bit</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="nb">varchar</span><span class="p">(</span><span class="k">max</span><span class="p">)</span>

<span class="k">BEGIN</span><span class="w"> </span><span class="n">TRY</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">fileAttachments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">email_AddFileAttachment</span><span class="p">(</span><span class="o">@</span><span class="n">fileAttachments</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;C:\logexport.txt&#39;</span><span class="p">)</span><span class="w">        </span><span class="c1">-- Add a file to the list of file attachments</span>

<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Test Clr Mail&#39;</span><span class="w"> </span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="o">@</span><span class="n">toEmailAddresses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;email1@gmail.com;email2@gmail.com&#39;</span>

<span class="w">    </span><span class="k">EXECUTE</span><span class="w"> </span><span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">clr_SimpleEmail</span><span class="p">]</span><span class="w"> </span>
<span class="w">        </span><span class="o">@</span><span class="n">subject</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">body</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">toEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">ccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">bccEmailAddresses</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">reportAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">excelAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">fileAttachments</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="w">        </span><span class="p">,</span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="k">OUTPUT</span>
<span class="k">END</span><span class="w"> </span><span class="n">TRY</span>
<span class="k">BEGIN</span><span class="w"> </span><span class="n">CATCH</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ERROR_MESSAGE</span><span class="p">()</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="k">END</span><span class="w"> </span><span class="n">CATCH</span>

<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="n">success</span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">message</span>
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.indexes", "navigation.top", "toc.follow", "content.code.copy", "content.tabs.link"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c18c5fb9.min.js"></script>
      
        <script src="../../extra_js/custom.js"></script>
      
    
  </body>
</html>